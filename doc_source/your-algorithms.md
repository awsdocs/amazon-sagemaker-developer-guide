# Use Your Own Algorithms or Models with Amazon SageMaker<a name="your-algorithms"></a>

Amazon SageMaker makes extensive use of *Docker containers* for build and runtime tasks\. Before using your own algorithm or model with Amazon SageMaker , you need to understand how Amazon SageMaker manages and runs them\. Amazon SageMaker provides pre\-built Docker images for its built\-in algorithms and the deep learning frameworks supported used for training and inference\. By using containers, you can train machine learning algorithms and deploy models quickly and reliably at any scale\. Docker is a program that performs operating\-system\-level virtualization for installing, distributing, and managing software\. It packages applications and their dependencies into virtual containers that provide isolation, portability, and security\.

You can put scripts, algorithms, and inference code for your machine learning models into containers\. The container includes the runtime, system tools, system libraries, and other code required to train your algorithms or deploy your models\. This gives you the flexibility to use almost any script or algorithm code with Amazon SageMaker, regardless of runtime or implementation language\. The code that runs in containers is effectively isolated from its surroundings, ensuring a consistent runtime, regardless of where the container is deployed\. After packaging your training code, inference code, or both into Docker containers, you can create algorithm resources and model package resources for use in Amazon SageMaker or to publish on AWS Marketplace\. With Docker, you can ship code faster, standardize application operations, seamlessly move code, and economize by improving resource utilization\.

You create Docker containers from *images* that are saved in a *repository*\. You build the images from scripted instructions provided in a *Dockerfile*\. To use Docker containers in Amazon SageMaker, the scripts that you use must satisfy certain requirements\. For information about the requirements, see [Use Your Own Training Algorithms](your-algorithms-training-algo.md) and [Use Your Own Inference Code](your-algorithms-inference-main.md)\. 

## Scenarios for Running Scripts, Training Algorithms, or Deploying Models with Amazon SageMaker<a name="container-scenarios"></a>

Amazon SageMaker always uses Docker containers when running scripts, training algorithms or deploying models\. However, your level of engagement with containers varies depending on whether you are using a built\-in algorithm provided by Amazon SageMaker or a script or model that you have developed yourself\. If you're using your own code, it also depends on the language and framework or environment used to develop it, and any other the dependencies it requires to run\. In particular, it depends on whether you use you use the Amazon SageMaker Python SDK or AWS SDK for Python \(Boto3\) or some other SDK\. Amazon SageMaker provides containers for its built\-in algorithms and pre\-built Docker images for some of the most common machine learning frameworks\. You can use the containers and images as provided or extend them to cover more complicated use cases\. You can also create your own container images to manage more advanced use cases not addressed by the containers provided by Amazon SageMaker\. 

There are four main scenarios for running scripts, algorithms, and models in the Amazon SageMaker environment\. The last three describe the scenarios covered here: the ways you can use containers to *bring your own script, algorithm or model*\.
+ **Use a built\-in algorithm**\. Containers are used behind the scenes when you use one of the Amazon SageMaker built\-in algorithms, but you do not deal with them directly\. You can train and deploy these algorithms from the Amazon SageMaker console, the AWS Command Line Interface \(AWS CLI\), a Python notebook, or the Amazon SageMaker Python SDK\. The built\-in algorithms available are itemized and described in the [Use Amazon SageMaker Built\-in Algorithms ](algos.md) topic\. For an example of how to train and deploy a build\-in algorithm using Jupyter Notebook running in an Amazon SageMaker notebook instance, see the [Get Started](gs.md) topic\. 
+ **Use pre\-built container images**\.Amazon SageMaker provides pre\-built containers to supports deep learning frameworks such as Apache MXNet, TensorFlow, PyTorch, and Chainer\. It also supports machine learning libraries such a scikit\-learn and SparkML by providing pre\-built Docker images\.  If you use the Amazon SageMaker Python SDK, they are deployed using their respective Amazon SageMaker SDK `Estimator` class\. In this case, you can supply the Python code that implements your algorithm and configure the pre\-built image to access your code as an entry point\. For a list of deep learning frameworks currently supported by Amazon SageMaker and samples that show how to use their pre\-build container images, see [Prebuilt Amazon SageMaker Docker Images for TensorFlow, MXNet, Chainer, and PyTorch](pre-built-containers-frameworks-deep-learning.md)\. For information on the scikit\-learn and SparkML pre\-built container images, see [Prebuilt Amazon SageMaker Docker Images for Scikit\-learn and Spark ML ](pre-built-docker-containers-frameworks.md)\. For more information about using frameworks with the Amazon SageMaker Python SDK, see their respective topics in [Use Machine Learning Frameworks with Amazon SageMaker](frameworks.md)\.
+ **Extend a pre\-built container image**\. If you have additional functional requirements for an algorithm or model that you developed in a framework that a pre\-built Amazon SageMaker Docker image doesn't support, you can modify an Amazon SageMaker image to satisfy your needs\. For an example, see [Extending our PyTorch containers](https://github.com/awslabs/amazon-sagemaker-examples/blob/master/advanced_functionality/pytorch_extending_our_containers/pytorch_extending_our_containers.ipynb)\. 
+ **Build your own custom container image**: If there is no pre\-built Amazon SageMaker container image that you can use or modify for an advanced scenario, you can package your own script or algorithm to use with Amazon SageMaker\.You can use any programming language or framework to develop your container\. For an example that shows how to build your own containers to train and host an algorithm, see [Bring Your Own R Algorithm](https://github.com/awslabs/amazon-sagemaker-examples/tree/master/advanced_functionality/r_bring_your_own)\.

The next topic provides a brief introduction to Docker containers\. Amazon SageMaker has certain contractual requirements that a container must satisfy to be used with it\. The following topic describes the Amazon SageMaker Containers library that can be used to create Amazon SageMaker\-compatible containers, including a list of the environmental variables it defines and may require\. Then a tutorial that shows how to get started by using Amazon SageMaker Containers to train a Python script\. After the tutorial, topics: 
+ Describe the pre\-built Docker containers provided by Amazon SageMaker for deep learning frameworks and other libraries\.
+ Provide examples of how to deploy containers for the various scenarios\.

Subsequent sections describe in more detail the contractual requirements to use Docker with Amazon SageMaker to train your custom algorithms and to deploy your inference code to make predictions\. There are two ways to make predictions when deploying a model\. First, to get individual, real\-time predictions, you can make inferences with a hosting services\. Second, to get predictions for an entire dataset, you can use a batch transform\. The final sections describe how to create algorithm and model package resources for use in your Amazon SageMaker account or to publish on AWS Marketplace\.

**Topics**
